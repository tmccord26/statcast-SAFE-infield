{
  "hash": "2d7c88604253c2b8c9f5c6d7638a1f2c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Modeling the Probability of a Ground Ball Being a Successful Play\"\nformat: html\n---\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.2\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(lme4)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: Matrix\n\nAttaching package: 'Matrix'\n\nThe following objects are masked from 'package:tidyr':\n\n    expand, pack, unpack\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(broom.mixed)\nlibrary(mgcv)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: nlme\n\nAttaching package: 'nlme'\n\nThe following object is masked from 'package:lme4':\n\n    lmList\n\nThe following object is masked from 'package:dplyr':\n\n    collapse\n\nThis is mgcv 1.9-1. For overview type 'help(\"mgcv-package\")'.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(ks)\n\nbip_gb <- readRDS(\"statcast_data/bip_gb.rds\")\nsafe_positioning <- readRDS(\"statcast_data/player_positioning/safe_positioning.rds\")\nsc_positioning <- readRDS(\"statcast_data/player_positioning/sc_positioning.rds\")\n```\n:::\n\n\n## Example: Successful Play Probability Model for SS in 2025\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Fitting a model for shortstops (SS) in 2025\n\npos_ss <- safe_positioning |>\n  filter(play_made_by == \"SS\")\n\nbip_gb_ss_2025 <- bip_gb |>\n  filter(\n    game_year == 2025,\n    (successful_play == 1 & play_made_by == \"SS\") | (successful_play == 0)\n  ) |>\n  mutate(\n    pos_x = pos_ss$pos_x,\n    pos_y = pos_ss$pos_y,\n    pos_angle = pos_ss$pos_angle,\n    theta = abs(pos_angle - spray_angle),\n    move_left = ifelse(spray_angle < pos_angle, 1, 0),\n    fielder_id = as.factor(fielder_6)\n  ) |>\n  # filter out NA for all variables used in the model\n  filter(\n    !is.na(launch_speed),\n    !is.na(theta),\n    theta <= 45\n  ) |>\n  # scaling continuous variables\n  mutate(\n    launch_speed_scaled = scale(launch_speed)[,1],\n    theta_scaled = scale(theta)[,1]\n  )\n\nplayers_num_plays <- bip_gb_ss_2025 |>\n  group_by(fielder_id) |>\n  summarise(num_plays = n()) |>\n  arrange(num_plays) |>\n  filter(num_plays >= 10) |>\n  pluck(\"fielder_id\")\n\nbip_gb_ss_2025 <- bip_gb_ss_2025 |>\n  filter(fielder_id %in% players_num_plays)\n```\n:::\n\n\n\n### Probit Regression (with full random effects)\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Probit regression model with full random effects\nmodel_ss_2025_re_full <- glmer(\n  out_ss ~ theta_scaled + theta_scaled:move_left + \n    theta_scaled:launch_speed_scaled + theta_scaled:launch_speed_scaled:move_left +\n    (1 + theta_scaled || fielder_id),\n  data = bip_gb_ss_2025,\n  family = binomial(link = \"probit\"),\n  control = glmerControl(optimizer = \"bobyqa\", optCtrl = list(maxfun = 2e5))\n)\n\nsummary(model_ss_2025_re_full)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGeneralized linear mixed model fit by maximum likelihood (Laplace\n  Approximation) [glmerMod]\n Family: binomial  ( probit )\nFormula: \nout_ss ~ theta_scaled + theta_scaled:move_left + theta_scaled:launch_speed_scaled +  \n    theta_scaled:launch_speed_scaled:move_left + (1 + theta_scaled ||  \n    fielder_id)\n   Data: bip_gb_ss_2025\nControl: glmerControl(optimizer = \"bobyqa\", optCtrl = list(maxfun = 2e+05))\n\n     AIC      BIC   logLik deviance df.resid \n 20232.2  20287.8 -10109.1  20218.2    20537 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-4.6807 -0.6260 -0.0338  0.6311 10.0512 \n\nRandom effects:\n Groups       Name         Variance Std.Dev.\n fielder_id   (Intercept)  0.002146 0.04633 \n fielder_id.1 theta_scaled 0.007719 0.08786 \nNumber of obs: 20544, groups:  fielder_id, 97\n\nFixed effects:\n                                           Estimate Std. Error z value Pr(>|z|)\n(Intercept)                                -0.17751    0.01307 -13.584  < 2e-16\ntheta_scaled                               -0.87114    0.02218 -39.276  < 2e-16\ntheta_scaled:move_left                     -0.53348    0.03003 -17.762  < 2e-16\ntheta_scaled:launch_speed_scaled           -0.02546    0.01789  -1.423 0.154616\ntheta_scaled:move_left:launch_speed_scaled  0.10298    0.02882   3.573 0.000353\n                                              \n(Intercept)                                ***\ntheta_scaled                               ***\ntheta_scaled:move_left                     ***\ntheta_scaled:launch_speed_scaled              \ntheta_scaled:move_left:launch_speed_scaled ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) tht_sc tht_:_ th_:__\ntheta_scald  0.100                     \ntht_scld:m_  0.222 -0.462              \ntht_scld:__ -0.032 -0.001 -0.010       \ntht_sc:_:__  0.038  0.000  0.040 -0.621\n```\n\n\n:::\n:::\n\n\n\n### Visualizing Random Intercepts\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# get random effects with standard errors for each fielder\nre_fielder <- ranef(model_ss_2025_re_full, condVar = TRUE)$fielder_id\n\nse_fielder <- sqrt(sapply(attr(re_fielder, \"postVar\"), function(x) x[1, 1, ]))\n\nfielder_effects <- data.frame(\n  fielder_id = rownames(re_fielder),\n  random_intercept = re_fielder[, 1],\n  random_theta = re_fielder[, 2],\n  se = se_fielder\n)\n```\n:::\n\n\n\n::: {#cell-fig-random-intercepts .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-random-intercepts\n#| fig-cap: \"Random Intercepts for SS Fielders in 2025 with 95% Confidence Intervals\"\n#| fig-width: 8\n#| fig-height: 6\n\nggplot(fielder_effects, aes(x = reorder(fielder_id, random_intercept), y = random_intercept)) +\n  geom_point() +\n  geom_errorbar(aes(ymin = random_intercept - 1.96 * `se..Intercept.`, ymax = random_intercept + 1.96 * `se..Intercept.`), width = 0.2) +\n  coord_flip() +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"red\") +\n  labs(\n    title = \"Random Intercepts for SS Fielders with 95% CI\",\n    x = \"Fielder ID\",\n    y = \"Random Intercept (u_i)\"\n  ) +\n  theme_classic() +\n  theme(\n    axis.text.y = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![Random Intercepts for SS Fielders in 2025 with 95% Confidence Intervals](probability_modeling_files/figure-html/fig-random-intercepts-1.png){#fig-random-intercepts width=768}\n:::\n:::\n\n\n\n::: {#cell-fig-random-slopes .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-random-slopes\n#| fig-cap: \"Random Slopes for Theta SS Fielders in 2025 with 95% Confidence Intervals\"\n#| fig-width: 8\n#| fig-height: 6\n\nggplot(fielder_effects, aes(x = reorder(fielder_id, random_theta), y = random_theta)) +\n  geom_point() +\n  geom_errorbar(aes(ymin = random_theta - 1.96 * `se.theta_scaled`, ymax = random_theta + 1.96 * `se.theta_scaled`), width = 0.2) +\n  coord_flip() +\n  geom_hline(yintercept = 0, linetype = \"dashed\", color = \"red\") +\n  labs(\n    title = \"Random Slopes for Theta SS Fielders with 95% CI\",\n    x = \"Fielder ID\",\n    y = \"Random Slope (u_theta)\"\n  ) +\n  theme_classic() +\n  theme(\n    axis.text.y = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![Random Slopes for Theta SS Fielders in 2025 with 95% Confidence Intervals](probability_modeling_files/figure-html/fig-random-slopes-1.png){#fig-random-slopes width=768}\n:::\n:::\n\n\n## SAFE Metric Calculation\n\n### 2D Kernel Density of Ground Balls by Spray Angle and Launch Speed\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nXY <- cbind(bip_gb$spray_angle, bip_gb$launch_speed)\nkde_fit <- kde(x = XY)\n\n# Search grid\nlaunch_speeds <- seq(50, 110, 1)\nspray_angles  <- seq(-45, 45, 1)\n\nbatted_balls <- expand.grid(\n  spray_angle = spray_angles,\n  launch_speed = launch_speeds\n)\n\n# Evaluate KDE directly at each grid point\nbatted_balls$density <- predict(\n  kde_fit,\n  x = cbind(batted_balls$spray_angle,\n            batted_balls$launch_speed)\n)\n\n# plot the densities\nggplot(batted_balls, aes(x = spray_angle, y = launch_speed, fill = density)) +\n  geom_tile() +\n  scale_fill_viridis_c() +\n  labs(\n    title = \"2D Kernel Density Estimate of Ground Balls by Spray Angle and Launch Speed\",\n    x = \"Spray Angle (degrees)\",\n    y = \"Launch Speed (mph)\",\n    fill = \"Density\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](probability_modeling_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n### Fitting a Run Value Model\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Fitting a run expectancy model\nmod_run_value <- gam(delta_run_exp ~ s(launch_speed) +\n                                     s(spray_angle) + \n                                     launch_speed:spray_angle,\n                     data = bip_gb)\n\nbatted_balls$run_value <- predict(mod_run_value, newdata = batted_balls)\n```\n:::\n\n\n\n### Function to Fit SAFE Model for a Given Position and Year\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nfit_SAFE <- function(bip_data, year, position, positioning_data, batted_balls, max_retries = 3) {\n  \n  # Merge position coordinates onto play data, filter to year, and compute features\n  play_data <- bip_data |>\n    filter(\n      (successful_play == 1 & play_made_by == position) | (successful_play == 0)\n    ) |>\n    mutate(\n      pos_x = positioning_data$pos_x,\n      pos_y = positioning_data$pos_y,\n      pos_angle = positioning_data$pos_angle,\n      theta = abs(pos_angle - spray_angle),\n      move_left = ifelse(spray_angle < pos_angle, 1, 0),\n      fielder_id = case_when(\n        position == \"1B\" ~ fielder_3,\n        position == \"2B\" ~ fielder_4,\n        position == \"3B\" ~ fielder_5,\n        position == \"SS\" ~ fielder_6,\n        TRUE ~ NA\n      )\n    ) |>\n    # scaling continuous variables\n    mutate(\n      launch_speed_scaled = scale(launch_speed)[,1],\n      theta_scaled = scale(theta)[,1]\n    ) |>\n    # filter out NA for all variables used in the model\n    filter(\n      !is.na(fielder_id),\n      !is.na(launch_speed),\n      !is.na(theta)\n    )\n  \n  players_num_plays <- play_data |>\n    group_by(fielder_id) |>\n    summarise(num_plays = n()) |>\n    arrange(num_plays) |>\n    filter(num_plays >= 10) |>\n    pluck(\"fielder_id\")\n\n  play_data <- play_data |>\n    filter(fielder_id %in% players_num_plays) |>\n    mutate(fielder_id = factor(fielder_id))\n  \n  # ---------------------------- PROBABILITY MODEL -----------------------------\n  \n  # Create the outcome variable name dynamically\n  outcome_var <- paste0(\"out_\", str_to_lower(position))\n  \n  formula_str_player <- paste0(\n    outcome_var, \" ~ 1 + theta_scaled + theta_scaled:move_left + \",\n    \"theta_scaled:launch_speed_scaled + theta_scaled:launch_speed_scaled:move_left + \",\n    \"(1 + theta_scaled || fielder_id)\"\n  )\n  \n  mod_player <- NULL\n  attempt <- 1\n  \n  while(is.null(mod_player) && attempt <= max_retries) {\n    \n    tryCatch({\n      \n      if (attempt == 1) {\n        # First attempt: default bobyqa\n        message(paste(\"Fitting model for\", position, year, \"- Attempt\", attempt))\n        mod_player <- glmer(\n          formula = as.formula(formula_str_player),\n          data = play_data,\n          family = binomial(link = \"probit\"),\n          control = glmerControl(\n            optimizer = \"bobyqa\",\n            optCtrl = list(maxfun = 2e5)\n          )\n        )\n        \n      } else if (attempt == 2) {\n        # Second attempt: Simplify random effects (intercept only)\n        message(paste(\"Retrying with simplified random effects for\", position, year))\n        formula_str_simple <- paste0(\n          outcome_var, \" ~ 1 + theta_scaled + theta_scaled:move_left + \",\n          \"theta_scaled:launch_speed_scaled + theta_scaled:launch_speed_scaled:move_left + \",\n          \"(1 | fielder_id)\"  # Only random intercept\n        )\n        mod_player <- glmer(\n          formula = as.formula(formula_str_simple),\n          data = play_data,\n          family = binomial(link = \"probit\"),\n          control = glmerControl(\n            optimizer = \"bobyqa\",\n            optCtrl = list(maxfun = 2e5)\n          )\n        )\n      }\n      \n    }, error = function(e) {\n      message(paste(\"Attempt\", attempt, \"failed for\", position, year, \":\", e$message))\n      mod_player <<- NULL\n    })\n    \n    attempt <- attempt + 1\n  }\n  \n  # If all attempts failed, return empty results\n  if (is.null(mod_player)) {\n    warning(paste(\"All attempts failed for\", position, year, \"- returning empty results\"))\n    return(data.frame(\n      fielder_id = character(),\n      position = character(),\n      year = numeric(),\n      SAFE = numeric()\n    ))\n  }\n  \n  message(paste(\"Successfully fit model for\", position, year))\n  \n  \n  # ---------------------- CALCULATING SAFE METRICS ----------------------------\n  \n  batted_balls <- batted_balls |>\n    mutate(\n      pos_angle = positioning_data$pos_angle,\n      theta = abs(pos_angle - spray_angle),\n      move_left = ifelse(spray_angle < pos_angle, 1, 0),\n      # standardize variables based on training data\n      launch_speed_scaled = (launch_speed - mean(play_data$launch_speed, na.rm = TRUE)) / sd(play_data$launch_speed, na.rm = TRUE),\n      theta_scaled = (theta - mean(play_data$theta, na.rm = TRUE)) / sd(play_data$theta, na.rm = TRUE),\n      run_value = predict(mod_run_value, newdata = batted_balls)\n    )\n  \n  fielders <- unique(play_data$fielder_id)\n  \n  # Set up a data frame to store SAFE results\n  safe_results <- data.frame()\n  \n  for (fielder in fielders) {\n    \n    bb_temp <- batted_balls\n    bb_temp$fielder_id <- factor(fielder, levels = levels(play_data$fielder_id))\n    n_opportunities <- nrow(play_data |> filter(fielder_id == fielder))\n    \n    # Check that this fielder exists in the model\n    if (!(fielder %in% levels(play_data$fielder_id))) {\n      next\n    }\n    \n    bb_temp <- bb_temp |>\n      mutate(\n        prob_play_player = predict(mod_player, newdata = bb_temp, type = \"response\"),\n        prob_play_avg = predict(mod_player, newdata = bb_temp, type = \"response\", re.form = NA),\n        prob_play_added = prob_play_player - prob_play_avg,\n        SAFE = prob_play_added * run_value * density\n      ) \n    \n    player_res <- bb_temp |>\n      summarize(\n        SAFE = sum(SAFE, na.rm = TRUE) * n_opportunities\n      )\n    \n    # append fielderid, position, SAFE, and num_plays to safe_results\n    safe_results <- rbind(safe_results, data.frame(\n      fielder_id = as.character(fielder),\n      position = position,\n      year = year,\n      SAFE = player_res$SAFE\n    ))\n\n  }\n  \n  return(safe_results)\n  \n}\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nyears <- c(2023, 2024, 2025)\npositions <- c(\"1B\", \"2B\", \"SS\", \"3B\")\n\n# Initialize results storage\nall_safe_results <- data.frame()\n\nfor (year in years) {\n  \n  bip_gb_year <- bip_gb |>\n    filter(game_year == year)\n  \n  for (position in positions) {\n    \n    safe_pos_year <- safe_positioning |>\n      filter(play_made_by == !!position)\n    \n    safe_results <- fit_SAFE(\n      bip_data = bip_gb_year,\n      year = year,\n      position = position,\n      positioning_data = safe_pos_year,\n      batted_balls = batted_balls\n    )\n    \n    # Accumulate results\n    all_safe_results <- rbind(all_safe_results, safe_results)\n  }\n  \n}\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nFitting model for 1B 2023 - Attempt 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSuccessfully fit model for 1B 2023\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nFitting model for 2B 2023 - Attempt 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSuccessfully fit model for 2B 2023\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nFitting model for SS 2023 - Attempt 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSuccessfully fit model for SS 2023\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nFitting model for 3B 2023 - Attempt 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSuccessfully fit model for 3B 2023\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nFitting model for 1B 2024 - Attempt 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nAttempt 1 failed for 1B 2024 : (maxstephalfit) PIRLS step-halvings failed to reduce deviance in pwrssUpdate\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRetrying with simplified random effects for 1B 2024\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nAttempt 2 failed for 1B 2024 : (maxstephalfit) PIRLS step-halvings failed to reduce deviance in pwrssUpdate\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in fit_SAFE(bip_data = bip_gb_year, year = year, position = position, :\nAll attempts failed for 1B 2024 - returning empty results\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nFitting model for 2B 2024 - Attempt 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSuccessfully fit model for 2B 2024\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nFitting model for SS 2024 - Attempt 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSuccessfully fit model for SS 2024\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nFitting model for 3B 2024 - Attempt 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSuccessfully fit model for 3B 2024\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nFitting model for 1B 2025 - Attempt 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nAttempt 1 failed for 1B 2025 : (maxstephalfit) PIRLS step-halvings failed to reduce deviance in pwrssUpdate\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRetrying with simplified random effects for 1B 2025\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nAttempt 2 failed for 1B 2025 : pwrssUpdate did not converge in (maxit) iterations\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in fit_SAFE(bip_data = bip_gb_year, year = year, position = position, :\nAll attempts failed for 1B 2025 - returning empty results\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nFitting model for 2B 2025 - Attempt 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nAttempt 1 failed for 2B 2025 : Downdated VtV is not positive definite\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRetrying with simplified random effects for 2B 2025\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSuccessfully fit model for 2B 2025\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nFitting model for SS 2025 - Attempt 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSuccessfully fit model for SS 2025\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nFitting model for 3B 2025 - Attempt 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nAttempt 1 failed for 3B 2025 : (maxstephalfit) PIRLS step-halvings failed to reduce deviance in pwrssUpdate\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRetrying with simplified random effects for 3B 2025\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nAttempt 2 failed for 3B 2025 : pwrssUpdate did not converge in (maxit) iterations\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning in fit_SAFE(bip_data = bip_gb_year, year = year, position = position, :\nAll attempts failed for 3B 2025 - returning empty results\n```\n\n\n:::\n:::\n\n\n\n\n## Results\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nall_safe_results |>\n  filter(year == 2024) |>\n  ggplot(aes(x = SAFE, color = position)) +\n  geom_density() \n```\n\n::: {.cell-output-display}\n![](probability_modeling_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n",
    "supporting": [
      "probability_modeling_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}